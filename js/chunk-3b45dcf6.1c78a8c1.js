(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b45dcf6"],{8944:function(t,e,n){},d275:function(t,e,n){},e3a0:function(t,e,n){"use strict";var i=n("d275"),a=n.n(i);a.a},eda6:function(t,e,n){"use strict";var i=n("8944"),a=n.n(i);a.a},efc3:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return W}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"dashboard-container"},[n("ErrorModal",{attrs:{close:t.closeError,messages:null===t.errorMessage?[]:[t.errorMessage]}}),n("div",{staticClass:"container--flex container--top"},[n("div",{staticClass:"container--card block--swap"},[null!==t.contract?n("div",[t._m(0),n("div",{staticClass:"swap-info"},[null!==t.vaults?n("div",[n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.depositAmount,expression:"depositAmount"}],staticStyle:{width:"7.5em"},attrs:{type:"number","aria-label":"Deposit amount",step:"0.000000000000000001"},domProps:{value:t.depositAmount},on:{input:function(e){e.target.composing||(t.depositAmount=e.target.value)}}}),n("button",{staticStyle:{"margin-left":"0.5em"},attrs:{disabled:""===t.depositAmount||t.depositAmount<=0},on:{click:t.deposit}},[t._v(" Deposit ")]),t._m(1),n("div",{staticStyle:{display:"inline-block"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.show,expression:"show"}],staticStyle:{"margin-left":"1.4em"},attrs:{id:"not-withdrawn",type:"radio"},domProps:{value:"not-withdrawn",checked:t._q(t.show,"not-withdrawn")},on:{change:function(e){t.show="not-withdrawn"}}}),n("label",{staticStyle:{"margin-left":"0.3em"},attrs:{for:"not-withdrawn"}},[t._v(" On stake ")])]),n("div",{staticStyle:{display:"inline-block"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.show,expression:"show"}],staticStyle:{"margin-left":"1.3em"},attrs:{id:"withdrawn",type:"radio"},domProps:{value:"withdrawn",checked:t._q(t.show,"withdrawn")},on:{change:function(e){t.show="withdrawn"}}}),n("label",{staticStyle:{"margin-left":"0.3em"},attrs:{for:"withdrawn"}},[t._v(" Withdrawn ")])])]),n("button",{staticStyle:{"margin-top":"0.25em"},on:{click:t.refresh}},[t._v(" Refresh ")]),n("br"),n("table",{staticStyle:{width:"100%"},attrs:{id:"staking-table"}},[n("caption",[t._v(" Deposits "),"not-withdrawn"===t.show?n("span",[t._v(" (on stake total: "+t._s(t.showDepositsAmount())+") ")]):t._e()]),n("thead",[n("tr",[n("th",{attrs:{scope:"col"}},[t._v("Label")]),n("th",{attrs:{scope:"col"}},[t._v("Deposit time")]),n("th",{attrs:{scope:"col"}},[t._v("Amount")]),n("th",{attrs:{scope:"col"}},[t._v("Earnings")]),n("th",{attrs:{scope:"col"}},[t._v("Percent")]),t.shouldShowDepositTypeColumn()?n("th",{attrs:{scope:"col"}},[t._v(" Type ")]):t._e(),"withdrawn"===t.show?[n("th",{attrs:{scope:"col"}},[t._v("Withdraw time")])]:[n("th",{attrs:{scope:"col"}},[t._v("Max withdrawable")]),n("th",{attrs:{scope:"col"}})]],2)]),n("tbody",t._l(t.vaults.filter((function(e){return void 0!==e.withdrawTime===("withdrawn"===t.show)})),(function(e){return n("tr",{key:e.id},[n("td",[t._v(t._s(e.label||""))]),n("td",[t._v(t._s(t.showDate(e.depositTime)))]),n("td",[t._v(t._s(t.web3.utils.fromWei(e.amount)))]),n("td",{staticStyle:{"font-family":"monospace"}},[t._v(" "+t._s(t.showInterest(e))+" ")]),n("td",[t._v(t._s(t.percent(e)))]),t.shouldShowDepositTypeColumn()?n("td",[t._v(" "+t._s(t.showDepositType(e))+" ")]):t._e(),void 0!==e.withdrawTime?[n("td",[t._v(" "+t._s(t.showDate(e.withdrawTime))+" ")])]:[n("td",[t._v(" "+t._s(t.web3.utils.fromWei(e.withdrawableAmount))+" ")]),n("td",[n("div",{staticStyle:{display:"flex"}},["NORMAL"!==e.depositType?n("input",{directives:[{name:"model",rawName:"v-model",value:e.withdrawInput,expression:"d.withdrawInput"}],staticStyle:{width:"7.5em","margin-right":"0.5em"},attrs:{type:"number","aria-label":"Withdraw amount"},domProps:{value:e.withdrawInput},on:{input:function(n){n.target.composing||t.$set(e,"withdrawInput",n.target.value)}}}):t._e(),n("button",{staticStyle:{"margin-left":"auto"},on:{click:function(n){return t.withdraw(e)}}},[t._v(" Withdraw ")])])])]],2)})),0)])]):n("div",[t._v("Loading...")])])]):t._e(),n("CompensationContract")],1)])],1)},a=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flex--row--align-center title"},[n("h4",[t._v("Staking contract")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticStyle:{"margin-left":"1em"}},[n("strong",[t._v("Show only:")])])}],r=(n("4de4"),n("7db0"),n("a630"),n("d81d"),n("13d5"),n("45fc"),n("b0c0"),n("b680"),n("d3b7"),n("ac1f"),n("3ca3"),n("5319"),n("ddb0"),n("96cf"),n("1da1")),o=n("5530"),s=n("2f62"),l=n("6314"),u=n.n(l),c=n("901e"),d=n.n(c),h=n("2b0e"),w=n("71e5"),m=n("8761"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("ErrorModal",{attrs:{close:t.closeError,messages:null===t.errorMessage?[]:[t.errorMessage]}}),null!==t.contract&&t.vaults.length>0?n("div",{staticStyle:{"padding-top":"50px"}},[t._m(0),n("div",{staticClass:"swap-info"},[n("table",{staticStyle:{width:"100%"},attrs:{id:"compensation-table"}},[n("caption",[t._v(" Deposits "),n("span",[t._v(" (on stake total: "+t._s(t.showDepositsAmount)+") ")])]),t._m(1),n("tbody",t._l(t.vaults,(function(e){return n("tr",{key:e.id},[n("td",[t._v(t._s(e.label))]),n("td",[t._v(" "+t._s(t.showDate(e.depositTime))+" ")]),n("td",[t._v(t._s(t.web3.utils.fromWei(e.amount)))]),n("td",[t._v(t._s(t.percent(e)))]),"withdrawn"===e.status.t?[n("td",[t._v("Withdrawn at: "+t._s(t.showDate(e.status.at)))])]:"withdrawableAt"===e.status.t?[n("td",[t._v("Withdrawable at: "+t._s(t.showDate(e.status.at)))])]:[n("td",[n("div",{staticStyle:{display:"flex"}},[n("button",{staticStyle:{"margin-left":"auto","font-size":"14px"},on:{click:function(n){return t.withdraw(e)}}},[t._v(" Withdraw ")])])])]],2)})),0)])])]):t._e()],1)},f=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flex--row--align-center title"},[n("h4",[t._v("Compensation contract")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",[n("th",{attrs:{scope:"col"}}),n("th",{attrs:{scope:"col"}},[t._v("Deposit time")]),n("th",{attrs:{scope:"col"}},[t._v("Amount")]),n("th",{attrs:{scope:"col"}},[t._v("Expected earnings")]),n("th",{attrs:{scope:"col"}})])])}],v=(n("a9e3"),n("25eb"),n("3835")),b=n("59c3"),_=function(t){return Array.from({length:t},(function(t,e){return e}))},g={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"};function y(t){var e=t.network,n=t.web3,i=e.type.contracts.find((function(t){return t.name===m["a"]}));return i?new n.eth.Contract(i.abi,i.address):null}var T=h["default"].extend({components:{ErrorModal:w["a"]},data:function(){var t={errorMessage:null,vaults:[],contract:y({network:this.$store.state.main.network,web3:this.$store.state.main.web3}),polling:null};return t},computed:Object(o["a"])(Object(o["a"])({},Object(s["c"])("main",["account","web3","network","wallet"])),{},{showDepositsAmount:function(){var t=this.vaults.reduce((function(t,e){return"withdrawn"===e.status.t?t:t.plus(e.amount)}),new d.a(0)).toFixed(),e=this.web3.utils.fromWei(t);return parseFloat(e).toFixed(8).replace(/(\.\d)*0+$/,"$1")}}),watch:{network:function(t){var e;this.account.identifier!==b["n"]&&(null===(e=this.wallet)||void 0===e?void 0:e.identifier)!==b["l"]||(null!==this.polling&&clearTimeout(this.polling),this.contract=y({network:t,web3:this.web3}),null!==this.contract&&this.updateVaultsLoop())},web3:function(t){var e;this.account.identifier!==b["n"]&&(null===(e=this.wallet)||void 0===e?void 0:e.identifier)!==b["l"]&&(null!==this.polling&&clearTimeout(this.polling),this.contract=y({network:this.network,web3:t}),null!==this.contract&&this.updateVaultsLoop())}},mounted:function(){null!==this.contract&&this.updateVaultsLoop()},beforeDestroy:function(){null!==this.polling&&clearTimeout(this.polling)},methods:{closeError:function(){this.errorMessage=null},showDate:function(t){return t.toLocaleString([],g)},updateVaultsLoop:function(){var t=this;null!==this.polling&&clearTimeout(this.polling);var e=this.contract.methods,n=this.account.address,i=Math.floor((new Date).getTime()/1e3);Promise.all([e.getVaultsLength(n).call(),e.interestStartTime().call()]).then((function(t){var e=Object(v["a"])(t,2),n=e[0],i=e[1];return[_(n),Number.parseInt(i)]})).then((function(t){var a=Object(v["a"])(t,2),r=a[0],o=a[1];return Promise.all(r.map((function(t){return e.getVaultById(n,t).call().then((function(e){var n=e.vault,a=n.label,r=n.depositTime,s=n.amount,l=n.premium,u=n.withdrawTime,c=n.duration;return{id:t,label:a,depositTime:new Date(1e3*parseInt(r)),amount:s,premium:new d.a(l).div(10),status:"0"!==u?{t:"withdrawn",at:new Date(1e3*parseInt(u))}:function(){var t=Math.ceil(Math.max(parseInt(r),o)+parseInt(c));return i<t?{t:"withdrawableAt",at:new Date(1e3*t)}:{t:"withdrawable"}}()}}))})))})).then((function(e){return t.vaults=e})).finally((function(){return t.polling=setTimeout((function(){return t.updateVaultsLoop()}),1e4)}))},withdraw:function(t){var e=this;this.contract.methods.withdraw(t.id).send({from:this.account.address}).then((function(){return e.updateVaultsLoop()})).catch((function(t){return e.errorMessage=t+""}))},percent:function(t){var e=t.premium;return e.toFixed(2)+" %"}}}),k=T,A=(n("e3a0"),n("2877")),D=Object(A["a"])(k,p,f,!1,null,"4445f0f8",null),x=D.exports,S=function(t){return Array.from({length:t},(function(t,e){return e}))},M={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"},E=function(t){switch(t){case"0":return"NORMAL";case"1":return"COMPENSATION";case"2":return"PACKAGE";default:throw new Error("Invalid deposit enum: "+t)}};function O(t){var e=t.network,n=t.web3,i=e.type.contracts.find((function(t){return t.name===m["f"]}));return void 0!==i?new n.eth.Contract(i.abi,i.address):null}var L=function(t){try{return t()}catch(e){return e instanceof Error?e:new Error(e+"")}},C=h["default"].extend({components:{CompensationContract:x,ErrorModal:w["a"]},data:function(){var t={errorMessage:null,depositAmount:"",vaults:null,contract:O({network:this.$store.state.main.network,web3:this.$store.state.main.web3}),polling:null,show:"not-withdrawn"};return t},computed:Object(o["a"])({},Object(s["c"])("main",["account","web3","network","wallet"])),watch:{network:function(t){var e;this.account.identifier!==b["n"]&&(null===(e=this.wallet)||void 0===e?void 0:e.identifier)!==b["l"]||(null!==this.polling&&clearTimeout(this.polling),this.vaults=null,this.contract=O({network:t,web3:this.web3}),null!==this.contract&&this.updateVaultsLoop())},web3:function(t){var e;this.account.identifier!==b["n"]&&(null===(e=this.wallet)||void 0===e?void 0:e.identifier)!==b["l"]&&(null!==this.polling&&clearTimeout(this.polling),this.vaults=null,this.contract=O({network:this.network,web3:t}),null!==this.contract&&this.updateVaultsLoop())}},mounted:function(){null!==this.contract&&this.updateVaultsLoop()},beforeDestroy:function(){null!==this.polling&&clearTimeout(this.polling)},methods:{closeError:function(){this.errorMessage=null},showDate:function(t){return t.toLocaleString([],M)},updateVaultsLoop:function(){var t=this;this.contract.methods.getVaultsLength(this.account.address).call().then(S).then((function(e){return Promise.all(e.map((function(e){return t.contract.methods.getVaultById(t.account.address,e).call().then((function(t){var e=t.vault,n=e.label,i=e.depositTime,a=e.amount,r=e.withdrawnAmount,o=e.withdrawTime,s=e.depositType,l=t.interest,u=t.withdrawableAmount;return{label:n,depositTime:new Date(1e3*parseInt(i)),amount:a,withdrawnAmount:r,interest:l,withdrawTime:new Date(1e3*parseInt(o)),withdrawableAmount:u,depositType:E(s)}})).then((function(t){var n=t.label,i=t.depositTime,a=t.amount,r=t.withdrawnAmount,s=t.interest,l=t.withdrawTime,u=t.withdrawableAmount,c=t.depositType,h=new d.a(a).minus(r);return Object(o["a"])(Object(o["a"])({id:e,label:n,depositTime:i},h.isEqualTo(0)?{amount:a,withdrawTime:l}:{amount:h.toFixed(),withdrawableAmount:u}),{},{interest:s,depositType:c})}))})))})).then((function(e){return t.vaults=e.map((function(e,n){return Object(o["a"])(Object(o["a"])({},e),{},{withdrawInput:t.vaults&&t.vaults[n]&&t.vaults[n].withdrawInput||""})}))})).finally((function(){return t.polling=setTimeout((function(){return t.updateVaultsLoop()}),1e4)}))},shouldShowDepositTypeColumn:function(){var t=this;return this.vaults.filter((function(e){return"withdrawTime"in e===("withdrawn"===t.show)})).some((function(t){return"NORMAL"!==t.depositType}))},showDepositsAmount:function(){var t=this.vaults.reduce((function(t,e){return"withdrawTime"in e?t:t.plus(e.amount)}),new d.a(0)).toFixed(),e=this.web3.utils.fromWei(t);return parseFloat(e).toFixed(8).replace(/(\.\d)*0+$/,"$1")},showInterest:function(t){return new d.a(this.web3.utils.fromWei(t.interest)).toFixed(8)},showDepositType:function(t){switch(t.depositType){case"NORMAL":return"Normal";case"COMPENSATION":return"Compensation";case"PACKAGE":return"Pacakge";default:throw new Error("Invalid deposit enum: "+t.depositType)}},deposit:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=L((function(){return u.a.utils.toWei(t.depositAmount,"ether")})),!(n instanceof Error)){e.next=5;break}t.errorMessage=n.message,e.next=10;break;case 5:return i=n,e.next=8,t.contract.methods.getMinDeposit().call();case 8:a=e.sent,new d.a(i).lt(a)?t.errorMessage="Amount to be deposited is less than the minimum allowed deposit ("+u.a.utils.fromWei(a)+")":t.contract.methods.deposit().send({from:t.account.address,value:i});case 10:case"end":return e.stop()}}),e)})))()},withdraw:function(t){this.contract.methods.withdraw(t.id,"NORMAL"===t.depositType?t.amount:this.web3.utils.toWei(t.withdrawInput)).send({from:this.account.address})},refresh:function(){clearTimeout(this.polling),this.vaults=null,this.updateVaultsLoop()},percent:function(t){var e=31556926e3,n=("withdrawTime"in t?t.withdrawTime:new Date).getTime()-t.depositTime.getTime(),i=new d.a(t.interest).dividedBy(t.amount).multipliedBy(new d.a(e).dividedBy(n)).multipliedBy(100);return i.toFixed(2)+" %"}}}),I=C,V=(n("eda6"),Object(A["a"])(I,i,a,!1,null,"70409ab1",null)),W=V.exports}}]);